<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Authentication Successful</title>
    <script>
        window.onload = () => {
            const message = { type: 'authSuccess' }; // ensure this matches frontend

            let messageSent = false;

            if (window.opener) {
                try {
                    window.opener.postMessage(message, '*');
                    messageSent = true;
                    window.close(); // close popup if it was a popup
                } catch (err) {
                    console.warn('Could not post message to opener:', err);
                }
            } else if (window.parent !== window) {
                try {
                    window.parent.postMessage(message, '*');
                    messageSent = true;
                } catch (err) {
                    console.warn('Could not post message to parent:', err);
                }
            }

            document.getElementById('message').textContent = messageSent
                ? 'Authentication complete. You can close this tab.'
                : 'Authentication complete. You may return to the original window.';
        };
    </script>
</head>
<body style="font-family: sans-serif; text-align: center; padding: 50px;">
    <h2 id="message">Completing authenticationâ€¦</h2>
</body>
</html>